import * as React from "react";
import { useState, useMemo } from "react";
import { Popover, PopoverContent, PopoverTrigger } from "@/components/ui/popover";
import { Input } from "@/components/ui/input";
import { Button } from "@/components/ui/button";
import { ScrollArea } from "@/components/ui/scroll-area";
import { X } from "lucide-react";

const EMOJI_DATA = [
  { emoji: "ðŸ ", keywords: ["home", "house", "building"] },
  { emoji: "ðŸ¡", keywords: ["home", "house", "garden"] },
  { emoji: "ðŸ“±", keywords: ["phone", "mobile", "cell"] },
  { emoji: "ðŸ’»", keywords: ["computer", "laptop", "tech"] },
  { emoji: "ðŸŽ®", keywords: ["game", "gaming", "controller", "play"] },
  { emoji: "ðŸŽ¨", keywords: ["art", "paint", "creative", "color"] },
  { emoji: "ðŸŽµ", keywords: ["music", "song", "audio", "sound"] },
  { emoji: "ðŸŽ¬", keywords: ["movie", "film", "video", "cinema"] },
  { emoji: "ðŸ“š", keywords: ["book", "books", "read", "library", "education"] },
  { emoji: "ðŸ“–", keywords: ["book", "read", "open"] },
  { emoji: "âœï¸", keywords: ["pencil", "write", "edit", "draw"] },
  { emoji: "ðŸ“", keywords: ["note", "memo", "write", "document"] },
  { emoji: "ðŸ“…", keywords: ["calendar", "date", "schedule", "event"] },
  { emoji: "ðŸ“†", keywords: ["calendar", "date", "schedule"] },
  { emoji: "ðŸ—“ï¸", keywords: ["calendar", "schedule", "planner"] },
  { emoji: "â°", keywords: ["clock", "time", "alarm"] },
  { emoji: "ðŸ•", keywords: ["clock", "time", "hour"] },
  { emoji: "â­", keywords: ["star", "favorite", "best"] },
  { emoji: "ðŸŒŸ", keywords: ["star", "sparkle", "shine", "special"] },
  { emoji: "ðŸ’«", keywords: ["star", "dizzy", "sparkle"] },
  { emoji: "âœ¨", keywords: ["sparkle", "shine", "magic", "special"] },
  { emoji: "â¤ï¸", keywords: ["heart", "love", "like", "favorite"] },
  { emoji: "ðŸ’–", keywords: ["heart", "love", "sparkle"] },
  { emoji: "ðŸ’", keywords: ["heart", "gift", "love"] },
  { emoji: "ðŸ§¡", keywords: ["heart", "orange", "love"] },
  { emoji: "ðŸ’›", keywords: ["heart", "yellow", "love"] },
  { emoji: "ðŸ’š", keywords: ["heart", "green", "love"] },
  { emoji: "ðŸ’™", keywords: ["heart", "blue", "love"] },
  { emoji: "ðŸ’œ", keywords: ["heart", "purple", "love"] },
  { emoji: "ðŸ–¤", keywords: ["heart", "black", "love"] },
  { emoji: "ðŸ¤", keywords: ["heart", "white", "love"] },
  { emoji: "ðŸ¤Ž", keywords: ["heart", "brown", "love"] },
  { emoji: "ðŸ˜€", keywords: ["smile", "happy", "face", "grin"] },
  { emoji: "ðŸ˜ƒ", keywords: ["smile", "happy", "face"] },
  { emoji: "ðŸ˜„", keywords: ["smile", "happy", "laugh"] },
  { emoji: "ðŸ˜", keywords: ["smile", "grin", "happy"] },
  { emoji: "ðŸ˜Š", keywords: ["smile", "blush", "happy", "warm"] },
  { emoji: "ðŸ¥°", keywords: ["love", "heart", "happy", "adore"] },
  { emoji: "ðŸ˜", keywords: ["love", "heart", "eyes", "adore"] },
  { emoji: "ðŸ¤©", keywords: ["star", "eyes", "excited", "wow"] },
  { emoji: "ðŸ˜Ž", keywords: ["cool", "sunglasses", "awesome"] },
  { emoji: "ðŸ¤—", keywords: ["hug", "happy", "warm"] },
  { emoji: "ðŸ™‚", keywords: ["smile", "slight", "okay"] },
  { emoji: "ðŸ‘‹", keywords: ["wave", "hello", "hi", "bye", "hand"] },
  { emoji: "ðŸ‘", keywords: ["thumbs", "up", "good", "like", "yes"] },
  { emoji: "ðŸ‘Ž", keywords: ["thumbs", "down", "bad", "dislike", "no"] },
  { emoji: "ðŸ‘", keywords: ["clap", "applause", "bravo"] },
  { emoji: "ðŸ™Œ", keywords: ["hands", "celebration", "hooray"] },
  { emoji: "ðŸ¤", keywords: ["handshake", "deal", "agree", "partner"] },
  { emoji: "ðŸ™", keywords: ["pray", "prayer", "hands", "please", "thank you", "folded", "namaste", "hope", "faith", "grateful"] },
  { emoji: "âœ‹", keywords: ["hand", "stop", "high five"] },
  { emoji: "ðŸ–ï¸", keywords: ["hand", "five", "fingers"] },
  { emoji: "ðŸ‘†", keywords: ["point", "up", "finger"] },
  { emoji: "ðŸ‘‡", keywords: ["point", "down", "finger"] },
  { emoji: "ðŸ‘ˆ", keywords: ["point", "left", "finger"] },
  { emoji: "ðŸ‘‰", keywords: ["point", "right", "finger"] },
  { emoji: "ðŸ•Šï¸", keywords: ["dove", "peace", "bird", "holy", "spirit", "faith"] },
  { emoji: "âœï¸", keywords: ["cross", "christian", "religion", "faith", "jesus"] },
  { emoji: "â˜®ï¸", keywords: ["peace", "symbol", "love"] },
  { emoji: "ðŸ•¯ï¸", keywords: ["candle", "prayer", "light", "memorial", "vigil"] },
  { emoji: "ðŸ˜‡", keywords: ["angel", "halo", "innocent", "blessed", "holy"] },
  { emoji: "ðŸ‘¼", keywords: ["angel", "baby", "cherub", "blessed"] },
  { emoji: "ðŸƒ", keywords: ["run", "runner", "exercise", "sport"] },
  { emoji: "ðŸš¶", keywords: ["walk", "walking", "person"] },
  { emoji: "ðŸ’ƒ", keywords: ["dance", "dancer", "party"] },
  { emoji: "ðŸ•º", keywords: ["dance", "dancer", "party", "disco"] },
  { emoji: "ðŸ§˜", keywords: ["yoga", "meditation", "zen", "calm"] },
  { emoji: "ðŸ‹ï¸", keywords: ["gym", "weight", "exercise", "fitness"] },
  { emoji: "ðŸš—", keywords: ["car", "drive", "vehicle", "auto"] },
  { emoji: "ðŸš•", keywords: ["taxi", "cab", "car"] },
  { emoji: "ðŸšŒ", keywords: ["bus", "transport", "vehicle"] },
  { emoji: "ðŸšŽ", keywords: ["trolley", "bus", "transport"] },
  { emoji: "ðŸŽï¸", keywords: ["race", "car", "fast", "speed"] },
  { emoji: "ðŸš€", keywords: ["rocket", "space", "launch", "fast"] },
  { emoji: "âœˆï¸", keywords: ["plane", "airplane", "flight", "travel"] },
  { emoji: "ðŸ›«", keywords: ["plane", "takeoff", "departure"] },
  { emoji: "ðŸ›¬", keywords: ["plane", "landing", "arrival"] },
  { emoji: "ðŸš", keywords: ["helicopter", "fly", "aircraft"] },
  { emoji: "ðŸš‚", keywords: ["train", "locomotive", "transport"] },
  { emoji: "ðŸšƒ", keywords: ["train", "railway", "car"] },
  { emoji: "ðŸš„", keywords: ["train", "bullet", "fast", "rail"] },
  { emoji: "ðŸ›’", keywords: ["cart", "shop", "shopping", "store", "buy"] },
  { emoji: "ðŸ›ï¸", keywords: ["bag", "shopping", "store", "buy"] },
  { emoji: "ðŸ’°", keywords: ["money", "bag", "dollar", "rich"] },
  { emoji: "ðŸ’µ", keywords: ["money", "dollar", "cash", "bill"] },
  { emoji: "ðŸ’³", keywords: ["card", "credit", "payment", "buy"] },
  { emoji: "ðŸŽ", keywords: ["gift", "present", "birthday", "surprise"] },
  { emoji: "ðŸŽˆ", keywords: ["balloon", "party", "celebration"] },
  { emoji: "ðŸŽ‰", keywords: ["party", "celebration", "confetti", "tada"] },
  { emoji: "ðŸŽŠ", keywords: ["confetti", "celebration", "party"] },
  { emoji: "ðŸŽ‚", keywords: ["cake", "birthday", "celebration"] },
  { emoji: "ðŸ°", keywords: ["cake", "dessert", "sweet"] },
  { emoji: "ðŸ§", keywords: ["cupcake", "dessert", "sweet"] },
  { emoji: "ðŸ•", keywords: ["pizza", "food", "slice"] },
  { emoji: "ðŸ”", keywords: ["burger", "hamburger", "food"] },
  { emoji: "ðŸŸ", keywords: ["fries", "french", "food"] },
  { emoji: "ðŸŒ­", keywords: ["hotdog", "food", "sausage"] },
  { emoji: "ðŸ¥ª", keywords: ["sandwich", "food", "lunch"] },
  { emoji: "ðŸŒ®", keywords: ["taco", "food", "mexican"] },
  { emoji: "ðŸŒ¯", keywords: ["burrito", "food", "wrap"] },
  { emoji: "ðŸ¥—", keywords: ["salad", "healthy", "food", "green"] },
  { emoji: "ðŸœ", keywords: ["noodles", "ramen", "food", "asian"] },
  { emoji: "ðŸ", keywords: ["pasta", "spaghetti", "food", "italian"] },
  { emoji: "ðŸ£", keywords: ["sushi", "food", "japanese", "fish"] },
  { emoji: "ðŸ¦", keywords: ["ice cream", "dessert", "sweet", "cold"] },
  { emoji: "ðŸ©", keywords: ["donut", "doughnut", "dessert", "sweet"] },
  { emoji: "ðŸª", keywords: ["cookie", "dessert", "sweet", "biscuit"] },
  { emoji: "â˜•", keywords: ["coffee", "drink", "hot", "cafe", "cup"] },
  { emoji: "ðŸµ", keywords: ["tea", "drink", "hot", "cup"] },
  { emoji: "ðŸ¥¤", keywords: ["drink", "soda", "cup", "beverage"] },
  { emoji: "ðŸ§ƒ", keywords: ["juice", "box", "drink"] },
  { emoji: "ðŸ·", keywords: ["wine", "drink", "alcohol", "glass"] },
  { emoji: "ðŸº", keywords: ["beer", "drink", "alcohol", "mug"] },
  { emoji: "ðŸ¶", keywords: ["dog", "puppy", "pet", "animal"] },
  { emoji: "ðŸ±", keywords: ["cat", "kitty", "pet", "animal"] },
  { emoji: "ðŸ­", keywords: ["mouse", "animal", "rodent"] },
  { emoji: "ðŸ¹", keywords: ["hamster", "pet", "animal"] },
  { emoji: "ðŸ°", keywords: ["rabbit", "bunny", "animal"] },
  { emoji: "ðŸ¦Š", keywords: ["fox", "animal", "wild"] },
  { emoji: "ðŸ»", keywords: ["bear", "animal", "wild"] },
  { emoji: "ðŸ¼", keywords: ["panda", "bear", "animal"] },
  { emoji: "ðŸ¨", keywords: ["koala", "animal", "australia"] },
  { emoji: "ðŸ¯", keywords: ["tiger", "animal", "wild", "cat"] },
  { emoji: "ðŸ¦", keywords: ["lion", "animal", "wild", "cat"] },
  { emoji: "ðŸ®", keywords: ["cow", "animal", "farm"] },
  { emoji: "ðŸ·", keywords: ["pig", "animal", "farm"] },
  { emoji: "ðŸ¸", keywords: ["frog", "animal", "green"] },
  { emoji: "ðŸµ", keywords: ["monkey", "animal", "ape"] },
  { emoji: "ðŸ”", keywords: ["chicken", "animal", "farm", "bird"] },
  { emoji: "ðŸ§", keywords: ["penguin", "animal", "bird", "cold"] },
  { emoji: "ðŸ¦", keywords: ["bird", "animal", "fly"] },
  { emoji: "ðŸ¦‹", keywords: ["butterfly", "insect", "pretty"] },
  { emoji: "ðŸ", keywords: ["bee", "insect", "honey"] },
  { emoji: "ðŸŒ¸", keywords: ["flower", "blossom", "cherry", "spring"] },
  { emoji: "ðŸŒº", keywords: ["flower", "hibiscus", "tropical"] },
  { emoji: "ðŸŒ»", keywords: ["flower", "sunflower", "yellow"] },
  { emoji: "ðŸŒ¹", keywords: ["rose", "flower", "red", "love"] },
  { emoji: "ðŸŒ·", keywords: ["tulip", "flower", "spring"] },
  { emoji: "ðŸŒ¼", keywords: ["flower", "blossom", "daisy"] },
  { emoji: "ðŸŒ±", keywords: ["plant", "seedling", "grow", "garden"] },
  { emoji: "ðŸŒ²", keywords: ["tree", "evergreen", "nature", "forest"] },
  { emoji: "ðŸŒ³", keywords: ["tree", "nature", "forest", "deciduous"] },
  { emoji: "ðŸŒ´", keywords: ["palm", "tree", "tropical", "beach"] },
  { emoji: "ðŸŒµ", keywords: ["cactus", "desert", "plant"] },
  { emoji: "ðŸ€", keywords: ["clover", "luck", "lucky", "four leaf"] },
  { emoji: "ðŸ", keywords: ["leaf", "maple", "fall", "autumn"] },
  { emoji: "ðŸ‚", keywords: ["leaves", "fall", "autumn"] },
  { emoji: "ðŸƒ", keywords: ["leaf", "wind", "nature"] },
  { emoji: "â˜€ï¸", keywords: ["sun", "sunny", "weather", "bright"] },
  { emoji: "ðŸŒ™", keywords: ["moon", "night", "crescent"] },
  { emoji: "â­", keywords: ["star", "night", "sky"] },
  { emoji: "ðŸŒˆ", keywords: ["rainbow", "color", "weather"] },
  { emoji: "â˜ï¸", keywords: ["cloud", "weather", "sky"] },
  { emoji: "â›…", keywords: ["cloud", "sun", "weather"] },
  { emoji: "ðŸŒ§ï¸", keywords: ["rain", "weather", "cloud"] },
  { emoji: "â›ˆï¸", keywords: ["storm", "thunder", "weather"] },
  { emoji: "â„ï¸", keywords: ["snow", "winter", "cold", "ice"] },
  { emoji: "ðŸ”¥", keywords: ["fire", "hot", "flame", "lit"] },
  { emoji: "ðŸ’§", keywords: ["water", "drop", "liquid"] },
  { emoji: "ðŸŒŠ", keywords: ["wave", "ocean", "sea", "water"] },
  { emoji: "ðŸ–ï¸", keywords: ["beach", "vacation", "summer", "sand"] },
  { emoji: "ðŸ•ï¸", keywords: ["camp", "camping", "tent", "outdoor"] },
  { emoji: "ðŸ”ï¸", keywords: ["mountain", "snow", "nature"] },
  { emoji: "â›°ï¸", keywords: ["mountain", "nature", "hike"] },
  { emoji: "ðŸ—»", keywords: ["mountain", "fuji", "japan"] },
  { emoji: "ðŸ ", keywords: ["house", "home", "building"] },
  { emoji: "ðŸ¢", keywords: ["building", "office", "work"] },
  { emoji: "ðŸ¥", keywords: ["hospital", "health", "medical"] },
  { emoji: "ðŸ«", keywords: ["school", "education", "building"] },
  { emoji: "ðŸ›ï¸", keywords: ["museum", "building", "classical"] },
  { emoji: "â›ª", keywords: ["church", "religion", "building"] },
  { emoji: "ðŸ•Œ", keywords: ["mosque", "religion", "building"] },
  { emoji: "ðŸª", keywords: ["store", "shop", "convenience"] },
  { emoji: "ðŸ¬", keywords: ["mall", "store", "department"] },
  { emoji: "ðŸ—¼", keywords: ["tower", "tokyo", "landmark"] },
  { emoji: "ðŸ—½", keywords: ["statue", "liberty", "landmark"] },
  { emoji: "âš½", keywords: ["soccer", "football", "sport", "ball"] },
  { emoji: "ðŸ€", keywords: ["basketball", "sport", "ball"] },
  { emoji: "ðŸˆ", keywords: ["football", "sport", "american"] },
  { emoji: "âš¾", keywords: ["baseball", "sport", "ball"] },
  { emoji: "ðŸŽ¾", keywords: ["tennis", "sport", "ball"] },
  { emoji: "ðŸ", keywords: ["volleyball", "sport", "ball"] },
  { emoji: "ðŸ“", keywords: ["ping pong", "table tennis", "sport"] },
  { emoji: "ðŸŽ¯", keywords: ["target", "dart", "bullseye", "goal"] },
  { emoji: "ðŸŽ³", keywords: ["bowling", "sport", "pins"] },
  { emoji: "ðŸŽ²", keywords: ["dice", "game", "random", "luck"] },
  { emoji: "ðŸ§©", keywords: ["puzzle", "game", "piece"] },
  { emoji: "â™Ÿï¸", keywords: ["chess", "game", "strategy"] },
  { emoji: "ðŸŽ­", keywords: ["theater", "drama", "mask", "arts"] },
  { emoji: "ðŸŽª", keywords: ["circus", "tent", "entertainment"] },
  { emoji: "ðŸŽ¤", keywords: ["microphone", "sing", "karaoke", "music"] },
  { emoji: "ðŸŽ§", keywords: ["headphones", "music", "listen", "audio"] },
  { emoji: "ðŸŽ¸", keywords: ["guitar", "music", "rock", "instrument"] },
  { emoji: "ðŸŽ¹", keywords: ["piano", "keyboard", "music", "instrument"] },
  { emoji: "ðŸ¥", keywords: ["drum", "music", "instrument"] },
  { emoji: "ðŸŽº", keywords: ["trumpet", "music", "brass", "instrument"] },
  { emoji: "ðŸŽ»", keywords: ["violin", "music", "string", "instrument"] },
  { emoji: "ðŸ“·", keywords: ["camera", "photo", "picture"] },
  { emoji: "ðŸ“¸", keywords: ["camera", "flash", "photo"] },
  { emoji: "ðŸ“¹", keywords: ["video", "camera", "record"] },
  { emoji: "ðŸŽ¥", keywords: ["movie", "camera", "film"] },
  { emoji: "ðŸ“º", keywords: ["tv", "television", "watch"] },
  { emoji: "ðŸ“»", keywords: ["radio", "music", "listen"] },
  { emoji: "ðŸ””", keywords: ["bell", "notification", "alert", "ring"] },
  { emoji: "ðŸ”•", keywords: ["bell", "mute", "silent"] },
  { emoji: "ðŸ“¢", keywords: ["megaphone", "announcement", "loud"] },
  { emoji: "ðŸ“£", keywords: ["megaphone", "cheer", "announcement"] },
  { emoji: "ðŸ’¬", keywords: ["speech", "bubble", "talk", "chat", "message"] },
  { emoji: "ðŸ’­", keywords: ["thought", "bubble", "think"] },
  { emoji: "ðŸ—¨ï¸", keywords: ["speech", "bubble", "left"] },
  { emoji: "ðŸ—¯ï¸", keywords: ["anger", "bubble", "mad"] },
  { emoji: "âœ‰ï¸", keywords: ["email", "mail", "letter", "envelope"] },
  { emoji: "ðŸ“§", keywords: ["email", "mail", "electronic"] },
  { emoji: "ðŸ“¨", keywords: ["envelope", "incoming", "mail"] },
  { emoji: "ðŸ“©", keywords: ["envelope", "arrow", "mail"] },
  { emoji: "ðŸ“®", keywords: ["mailbox", "post", "mail"] },
  { emoji: "ðŸ“¦", keywords: ["package", "box", "delivery", "ship"] },
  { emoji: "ðŸ“‹", keywords: ["clipboard", "list", "document"] },
  { emoji: "ðŸ“", keywords: ["folder", "file", "document"] },
  { emoji: "ðŸ“‚", keywords: ["folder", "open", "file"] },
  { emoji: "ðŸ—‚ï¸", keywords: ["folder", "divider", "organize"] },
  { emoji: "ðŸ“Š", keywords: ["chart", "graph", "data", "stats"] },
  { emoji: "ðŸ“ˆ", keywords: ["chart", "graph", "up", "increase"] },
  { emoji: "ðŸ“‰", keywords: ["chart", "graph", "down", "decrease"] },
  { emoji: "ðŸ”", keywords: ["search", "magnify", "look", "find"] },
  { emoji: "ðŸ”Ž", keywords: ["search", "magnify", "right"] },
  { emoji: "ðŸ”", keywords: ["lock", "key", "secure", "password"] },
  { emoji: "ðŸ”’", keywords: ["lock", "secure", "closed"] },
  { emoji: "ðŸ”“", keywords: ["lock", "unlock", "open"] },
  { emoji: "ðŸ”‘", keywords: ["key", "lock", "password", "access"] },
  { emoji: "ðŸ› ï¸", keywords: ["tools", "wrench", "hammer", "fix"] },
  { emoji: "ðŸ”§", keywords: ["wrench", "tool", "fix"] },
  { emoji: "ðŸ”¨", keywords: ["hammer", "tool", "build"] },
  { emoji: "âš™ï¸", keywords: ["gear", "settings", "cog", "config"] },
  { emoji: "ðŸ§²", keywords: ["magnet", "attract"] },
  { emoji: "ðŸ’¡", keywords: ["light", "bulb", "idea", "bright"] },
  { emoji: "ðŸ”¦", keywords: ["flashlight", "light", "torch"] },
  { emoji: "ðŸ•¯ï¸", keywords: ["candle", "light", "flame"] },
  { emoji: "ðŸ“Œ", keywords: ["pin", "location", "pushpin"] },
  { emoji: "ðŸ“", keywords: ["pin", "location", "map", "place"] },
  { emoji: "ðŸ—ºï¸", keywords: ["map", "world", "travel"] },
  { emoji: "ðŸ§­", keywords: ["compass", "direction", "navigate"] },
  { emoji: "ðŸš©", keywords: ["flag", "red", "mark"] },
  { emoji: "ðŸ", keywords: ["flag", "checkered", "finish", "race"] },
  { emoji: "ðŸŽŒ", keywords: ["flag", "japan", "crossed"] },
  { emoji: "ðŸ³ï¸", keywords: ["flag", "white", "surrender"] },
  { emoji: "ðŸ´", keywords: ["flag", "black"] },
  { emoji: "âš ï¸", keywords: ["warning", "caution", "alert"] },
  { emoji: "ðŸš«", keywords: ["no", "forbidden", "prohibited"] },
  { emoji: "â›”", keywords: ["stop", "no entry", "forbidden"] },
  { emoji: "âŒ", keywords: ["x", "cross", "no", "wrong", "delete"] },
  { emoji: "â­•", keywords: ["circle", "o", "ring"] },
  { emoji: "âœ…", keywords: ["check", "yes", "done", "complete"] },
  { emoji: "â˜‘ï¸", keywords: ["check", "box", "vote"] },
  { emoji: "âœ”ï¸", keywords: ["check", "tick", "yes", "correct"] },
  { emoji: "â“", keywords: ["question", "help", "ask"] },
  { emoji: "â”", keywords: ["question", "white"] },
  { emoji: "â—", keywords: ["exclamation", "important", "alert"] },
  { emoji: "â•", keywords: ["exclamation", "white"] },
  { emoji: "âž•", keywords: ["plus", "add", "new"] },
  { emoji: "âž–", keywords: ["minus", "subtract", "remove"] },
  { emoji: "âž—", keywords: ["divide", "division", "math"] },
  { emoji: "âœ–ï¸", keywords: ["multiply", "x", "times"] },
  { emoji: "ðŸ’¯", keywords: ["hundred", "perfect", "score", "100"] },
  { emoji: "ðŸ”¢", keywords: ["numbers", "123", "count"] },
  { emoji: "ðŸ”¤", keywords: ["letters", "abc", "alphabet"] },
  { emoji: "ðŸ” ", keywords: ["letters", "uppercase", "capital"] },
  { emoji: "ðŸ”¡", keywords: ["letters", "lowercase", "small"] },
  { emoji: "â„¹ï¸", keywords: ["info", "information", "help"] },
  { emoji: "ðŸ†•", keywords: ["new", "fresh", "latest"] },
  { emoji: "ðŸ†“", keywords: ["free", "gratis"] },
  { emoji: "ðŸ†—", keywords: ["ok", "okay", "button"] },
  { emoji: "ðŸ†™", keywords: ["up", "button", "level"] },
  { emoji: "ðŸ”™", keywords: ["back", "arrow", "return"] },
  { emoji: "ðŸ”š", keywords: ["end", "arrow"] },
  { emoji: "ðŸ”›", keywords: ["on", "arrow"] },
  { emoji: "ðŸ”œ", keywords: ["soon", "arrow"] },
  { emoji: "ðŸ”", keywords: ["top", "arrow", "up"] },
  { emoji: "â¬†ï¸", keywords: ["up", "arrow", "north"] },
  { emoji: "â¬‡ï¸", keywords: ["down", "arrow", "south"] },
  { emoji: "â¬…ï¸", keywords: ["left", "arrow", "west"] },
  { emoji: "âž¡ï¸", keywords: ["right", "arrow", "east"] },
  { emoji: "â†—ï¸", keywords: ["arrow", "northeast", "up right"] },
  { emoji: "â†˜ï¸", keywords: ["arrow", "southeast", "down right"] },
  { emoji: "â†™ï¸", keywords: ["arrow", "southwest", "down left"] },
  { emoji: "â†–ï¸", keywords: ["arrow", "northwest", "up left"] },
  { emoji: "â†•ï¸", keywords: ["arrow", "up down", "vertical"] },
  { emoji: "â†”ï¸", keywords: ["arrow", "left right", "horizontal"] },
  { emoji: "ðŸ”€", keywords: ["shuffle", "random", "mix"] },
  { emoji: "ðŸ”", keywords: ["repeat", "loop", "replay"] },
  { emoji: "ðŸ”‚", keywords: ["repeat", "one", "single"] },
  { emoji: "â–¶ï¸", keywords: ["play", "start", "forward"] },
  { emoji: "â¸ï¸", keywords: ["pause", "stop", "wait"] },
  { emoji: "â¹ï¸", keywords: ["stop", "end"] },
  { emoji: "âºï¸", keywords: ["record", "dot"] },
  { emoji: "â­ï¸", keywords: ["next", "forward", "skip"] },
  { emoji: "â®ï¸", keywords: ["previous", "back", "rewind"] },
  { emoji: "ðŸ”´", keywords: ["red", "circle", "dot"] },
  { emoji: "ðŸŸ ", keywords: ["orange", "circle", "dot"] },
  { emoji: "ðŸŸ¡", keywords: ["yellow", "circle", "dot"] },
  { emoji: "ðŸŸ¢", keywords: ["green", "circle", "dot"] },
  { emoji: "ðŸ”µ", keywords: ["blue", "circle", "dot"] },
  { emoji: "ðŸŸ£", keywords: ["purple", "circle", "dot"] },
  { emoji: "ðŸŸ¤", keywords: ["brown", "circle", "dot"] },
  { emoji: "âš«", keywords: ["black", "circle", "dot"] },
  { emoji: "âšª", keywords: ["white", "circle", "dot"] },
  { emoji: "ðŸŸ¥", keywords: ["red", "square"] },
  { emoji: "ðŸŸ§", keywords: ["orange", "square"] },
  { emoji: "ðŸŸ¨", keywords: ["yellow", "square"] },
  { emoji: "ðŸŸ©", keywords: ["green", "square"] },
  { emoji: "ðŸŸ¦", keywords: ["blue", "square"] },
  { emoji: "ðŸŸª", keywords: ["purple", "square"] },
  { emoji: "ðŸŸ«", keywords: ["brown", "square"] },
  { emoji: "â¬›", keywords: ["black", "square"] },
  { emoji: "â¬œ", keywords: ["white", "square"] },
  { emoji: "ðŸ‘¨â€ðŸ‘©â€ðŸ‘§", keywords: ["family", "parents", "child"] },
  { emoji: "ðŸ‘¨â€ðŸ‘©â€ðŸ‘¦", keywords: ["family", "parents", "child", "boy"] },
  { emoji: "ðŸ‘ª", keywords: ["family", "parents", "child"] },
  { emoji: "ðŸ‘¥", keywords: ["people", "group", "community"] },
  { emoji: "ðŸ‘¤", keywords: ["person", "user", "profile"] },
  { emoji: "ðŸ§‘â€ðŸ¤â€ðŸ§‘", keywords: ["people", "holding hands", "together"] },
  { emoji: "ðŸ‘«", keywords: ["couple", "holding hands", "together"] },
  { emoji: "ðŸ‘­", keywords: ["women", "holding hands", "friends"] },
  { emoji: "ðŸ‘¬", keywords: ["men", "holding hands", "friends"] },
  { emoji: "ðŸ§‘â€ðŸ¦±", keywords: ["person", "curly hair"] },
  { emoji: "ðŸ§‘â€ðŸ¦°", keywords: ["person", "red hair", "ginger"] },
  { emoji: "ðŸ§‘â€ðŸ¦³", keywords: ["person", "white hair", "gray"] },
  { emoji: "ðŸ§‘â€ðŸ¦²", keywords: ["person", "bald"] },
  { emoji: "ðŸ‘¶", keywords: ["baby", "child", "infant"] },
  { emoji: "ðŸ§’", keywords: ["child", "kid", "young"] },
  { emoji: "ðŸ‘¦", keywords: ["boy", "child", "young"] },
  { emoji: "ðŸ‘§", keywords: ["girl", "child", "young"] },
  { emoji: "ðŸ§‘", keywords: ["person", "adult"] },
  { emoji: "ðŸ‘¨", keywords: ["man", "adult", "male"] },
  { emoji: "ðŸ‘©", keywords: ["woman", "adult", "female"] },
  { emoji: "ðŸ§“", keywords: ["older", "adult", "elder"] },
  { emoji: "ðŸ‘´", keywords: ["old", "man", "grandfather"] },
  { emoji: "ðŸ‘µ", keywords: ["old", "woman", "grandmother"] },
  { emoji: "ðŸ§‘â€âš•ï¸", keywords: ["doctor", "health", "medical", "nurse"] },
  { emoji: "ðŸ‘¨â€âš•ï¸", keywords: ["doctor", "man", "health"] },
  { emoji: "ðŸ‘©â€âš•ï¸", keywords: ["doctor", "woman", "health"] },
  { emoji: "ðŸ§‘â€ðŸŽ“", keywords: ["student", "graduate", "education"] },
  { emoji: "ðŸ‘¨â€ðŸŽ“", keywords: ["student", "man", "graduate"] },
  { emoji: "ðŸ‘©â€ðŸŽ“", keywords: ["student", "woman", "graduate"] },
  { emoji: "ðŸ§‘â€ðŸ«", keywords: ["teacher", "education", "professor"] },
  { emoji: "ðŸ‘¨â€ðŸ«", keywords: ["teacher", "man", "professor"] },
  { emoji: "ðŸ‘©â€ðŸ«", keywords: ["teacher", "woman", "professor"] },
  { emoji: "ðŸ§‘â€ðŸ³", keywords: ["chef", "cook", "food"] },
  { emoji: "ðŸ‘¨â€ðŸ³", keywords: ["chef", "man", "cook"] },
  { emoji: "ðŸ‘©â€ðŸ³", keywords: ["chef", "woman", "cook"] },
  { emoji: "ðŸ§‘â€ðŸŽ¨", keywords: ["artist", "paint", "creative"] },
  { emoji: "ðŸ‘¨â€ðŸŽ¨", keywords: ["artist", "man", "paint"] },
  { emoji: "ðŸ‘©â€ðŸŽ¨", keywords: ["artist", "woman", "paint"] },
  { emoji: "ðŸ§‘â€ðŸ’»", keywords: ["technologist", "computer", "developer", "programmer"] },
  { emoji: "ðŸ‘¨â€ðŸ’»", keywords: ["technologist", "man", "computer"] },
  { emoji: "ðŸ‘©â€ðŸ’»", keywords: ["technologist", "woman", "computer"] },
  { emoji: "ðŸ§‘â€ðŸ”¬", keywords: ["scientist", "research", "lab"] },
  { emoji: "ðŸ‘¨â€ðŸ”¬", keywords: ["scientist", "man", "research"] },
  { emoji: "ðŸ‘©â€ðŸ”¬", keywords: ["scientist", "woman", "research"] },
  { emoji: "ðŸ§‘â€ðŸš€", keywords: ["astronaut", "space", "rocket"] },
  { emoji: "ðŸ‘¨â€ðŸš€", keywords: ["astronaut", "man", "space"] },
  { emoji: "ðŸ‘©â€ðŸš€", keywords: ["astronaut", "woman", "space"] },
  { emoji: "ðŸ§‘â€ðŸš’", keywords: ["firefighter", "fire", "rescue"] },
  { emoji: "ðŸ‘¨â€ðŸš’", keywords: ["firefighter", "man", "fire"] },
  { emoji: "ðŸ‘©â€ðŸš’", keywords: ["firefighter", "woman", "fire"] },
  { emoji: "ðŸ‘®", keywords: ["police", "officer", "cop"] },
  { emoji: "ðŸ¦¸", keywords: ["superhero", "hero", "power"] },
  { emoji: "ðŸ¦¹", keywords: ["supervillain", "villain", "evil"] },
  { emoji: "ðŸ§™", keywords: ["mage", "wizard", "magic"] },
  { emoji: "ðŸ§š", keywords: ["fairy", "magic", "fantasy"] },
  { emoji: "ðŸ§›", keywords: ["vampire", "dracula", "halloween"] },
  { emoji: "ðŸ§œ", keywords: ["merperson", "mermaid", "ocean"] },
  { emoji: "ðŸ§", keywords: ["elf", "fantasy", "magic"] },
  { emoji: "ðŸ§ž", keywords: ["genie", "magic", "wish"] },
  { emoji: "ðŸ§Ÿ", keywords: ["zombie", "undead", "halloween"] },
  { emoji: "ðŸ‘»", keywords: ["ghost", "halloween", "spooky"] },
  { emoji: "ðŸ’€", keywords: ["skull", "death", "skeleton"] },
  { emoji: "â˜ ï¸", keywords: ["skull", "crossbones", "danger"] },
  { emoji: "ðŸ‘½", keywords: ["alien", "space", "ufo"] },
  { emoji: "ðŸ‘¾", keywords: ["alien", "monster", "game"] },
  { emoji: "ðŸ¤–", keywords: ["robot", "machine", "android"] },
  { emoji: "ðŸŽƒ", keywords: ["pumpkin", "halloween", "jack-o-lantern"] },
  { emoji: "ðŸ˜ˆ", keywords: ["devil", "smile", "purple"] },
  { emoji: "ðŸ‘¿", keywords: ["devil", "angry", "imp"] },
  { emoji: "ðŸ‘¹", keywords: ["ogre", "monster", "red"] },
  { emoji: "ðŸ‘º", keywords: ["goblin", "monster", "red"] },
  { emoji: "ðŸ’©", keywords: ["poop", "poo", "pile"] },
  { emoji: "ðŸ¤¡", keywords: ["clown", "face", "circus"] },
  { emoji: "ðŸ›¡ï¸", keywords: ["shield", "protect", "defense"] },
  { emoji: "âš”ï¸", keywords: ["sword", "crossed", "battle"] },
  { emoji: "ðŸ—¡ï¸", keywords: ["dagger", "knife", "weapon"] },
  { emoji: "ðŸ¹", keywords: ["bow", "arrow", "archery"] },
  { emoji: "ðŸ”®", keywords: ["crystal", "ball", "fortune", "magic"] },
  { emoji: "ðŸ’Ž", keywords: ["gem", "diamond", "jewel", "precious"] },
  { emoji: "ðŸ‘‘", keywords: ["crown", "king", "queen", "royal"] },
  { emoji: "ðŸ’", keywords: ["ring", "wedding", "engaged", "diamond"] },
  { emoji: "ðŸ‘“", keywords: ["glasses", "eyeglasses", "spectacles"] },
  { emoji: "ðŸ•¶ï¸", keywords: ["sunglasses", "cool", "shades"] },
  { emoji: "ðŸŽ’", keywords: ["backpack", "bag", "school"] },
  { emoji: "ðŸ‘œ", keywords: ["handbag", "purse", "bag"] },
  { emoji: "ðŸ‘›", keywords: ["purse", "wallet", "money"] },
  { emoji: "ðŸ‘", keywords: ["pouch", "bag", "clutch"] },
  { emoji: "ðŸ§³", keywords: ["luggage", "suitcase", "travel"] },
  { emoji: "ðŸŒ‚", keywords: ["umbrella", "closed", "rain"] },
  { emoji: "â˜‚ï¸", keywords: ["umbrella", "rain", "weather"] },
  { emoji: "ðŸŽ€", keywords: ["ribbon", "bow", "gift", "pink"] },
  { emoji: "ðŸ§¸", keywords: ["teddy", "bear", "toy", "stuffed"] },
  { emoji: "ðŸª€", keywords: ["yo-yo", "toy", "play"] },
  { emoji: "ðŸª", keywords: ["kite", "fly", "wind"] },
  { emoji: "ðŸ›¸", keywords: ["ufo", "flying", "saucer", "alien"] },
  { emoji: "ðŸš¨", keywords: ["siren", "police", "emergency", "light"] },
  { emoji: "ðŸ”†", keywords: ["bright", "sun", "high", "brightness"] },
  { emoji: "ðŸ”…", keywords: ["dim", "low", "brightness"] },
];

interface EmojiPickerProps {
  value: string | null | undefined;
  onChange: (emoji: string | null) => void;
  placeholder?: string;
  title?: string;
}

export function EmojiPicker({ value, onChange, placeholder = "Select emoji", title }: EmojiPickerProps) {
  const [open, setOpen] = useState(false);
  const [search, setSearch] = useState("");

  const filteredEmojis = useMemo(() => {
    if (!search.trim()) {
      return EMOJI_DATA.slice(0, 50); // Show first 50 when no search
    }
    const searchLower = search.toLowerCase();
    return EMOJI_DATA.filter(
      (item) =>
        item.keywords.some((keyword) => keyword.includes(searchLower)) ||
        item.emoji.includes(search)
    );
  }, [search]);

  const handleSelect = (emoji: string) => {
    onChange(emoji);
    setOpen(false);
    setSearch("");
  };

  const handleClear = (e: React.MouseEvent) => {
    e.stopPropagation();
    onChange(null);
  };

  return (
    <Popover open={open} onOpenChange={setOpen}>
      <PopoverTrigger asChild>
        <Button
          variant="outline"
          className="w-full justify-between text-lg h-10"
          title={title}
        >
          {value ? (
            <span className="flex items-center gap-2">
              <span>{value}</span>
              <X
                className="h-3 w-3 text-muted-foreground hover:text-foreground"
                onClick={handleClear}
              />
            </span>
          ) : (
            <span className="text-muted-foreground text-sm">{placeholder}</span>
          )}
        </Button>
      </PopoverTrigger>
      <PopoverContent className="w-72 p-2 z-50" align="start">
        <Input
          placeholder="Search emojis (e.g., home, star, heart)..."
          value={search}
          onChange={(e) => setSearch(e.target.value)}
          className="mb-2"
          autoFocus
        />
        <ScrollArea className="h-48">
          {filteredEmojis.length > 0 ? (
            <div className="grid grid-cols-6 gap-1">
              {filteredEmojis.map((item, index) => (
                <Button
                  key={`${item.emoji}-${index}`}
                  variant="ghost"
                  className="h-9 w-9 p-0 text-xl hover:bg-accent"
                  onClick={() => handleSelect(item.emoji)}
                  title={item.keywords.join(", ")}
                >
                  {item.emoji}
                </Button>
              ))}
            </div>
          ) : (
            <div className="text-center text-muted-foreground text-sm py-4">
              No emojis found for "{search}"
            </div>
          )}
        </ScrollArea>
      </PopoverContent>
    </Popover>
  );
}
